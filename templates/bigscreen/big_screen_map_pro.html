<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title></title>
    <!-- 引入样式 -->
    <link rel="stylesheet" type="text/css" href="../../static/css/element.css">
    <link rel="stylesheet" type="text/css" href="../../static/css/zxx.lib.css">
    <link rel="stylesheet" type="text/css" href="../../static/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="../../static/css/app.css">
    <link rel="stylesheet" type="text/css" href="../../static/css/bigscreen/map_pro.css">
</head>

<body class="fw map-bg">
    <div id="app">
        <div class="application-box tc abs">
            <!-- 左侧 -->
            <div class="map-menu-left p10 map-bg">
                <!-- 收缩按钮 -->
                <a id="menu-toggle-btn" class="abs db el-icon-arrow-left menu-toggle-btn f12 tc" href="javascript:;"></a>

                <div id="menu-box" class="f12">
                    <el-form ref="form" :model="form" label-width="80px">
                        <div class="search_top">
                            <el-select placeholder="请输入地址" class="input-with-select map_slt l b_r">
                                <el-option label="北京" value="北京"></el-option>
                                <el-option label="天津" value="天津"></el-option>
                                <el-option label="河北" value="河北"></el-option>
                            </el-select>
                            <el-button class="l ml5" type="primary">搜索</el-button>
                        </div>
                        <div class="bx">
                            <el-collapse class="res_slt">
                                <el-collapse-item title="更多搜索选项" name="4">
                                    <div>
                                        <el-dropdown-item>
                                            <el-input placeholder="主体名称"></el-input>
                                        </el-dropdown-item>
                                        <el-dropdown-item style="font-size:1px;" action="" method="get">
                                            <el-checkbox name="Fruit" label="重点单位"></el-checkbox>
                                            <br/>
                                            <el-checkbox name="Fruit" label="重大活动或会议"></el-checkbox>
                                            <br/>
                                            <el-checkbox name="Fruit" label="其他对象"></el-checkbox>
                                        </el-dropdown-item>
                                        <el-dropdown-item>
                                            <el-input placeholder="地址"></el-input>
                                        </el-dropdown-item>
                                        <el-dropdown-item>
                                            <el-date-picker class="w190" type="date" placeholder="录入日期"></el-date-picker>
                                        </el-dropdown-item>
                                    </div>
                                </el-collapse-item>
                            </el-collapse>
                        </div>
                        <!-- <table border="0" style="color:#ffffff;font-size:15px;position:absolute;top:100px;left:60px;border-collapse:separate; border-spacing:0px 12px;">
                                    <tr v-for = "data in tableData" >
                                        <td>{{data.DWMC}}</td>
                                    </tr>
                                </table>  -->
                        <div class="menu-box-main">
                            <el-card v-for="data in tableData" :body-style="{ padding: '0px' }" style="background-color:#708090;color:#fff;">
                                <div slot="header">
                                    <strong>{{data.DWMC }}</strong>&nbsp&nbsp
                                    <el-tag color="#0f82ee" size="medium">{{data.DWXZ}}</el-tag>
                                </div>
                                <div class="l cell_bk">地址：{{data.DWDZ }}</div>
                                <div class="l cell_bk">电话：{{data.DWDH }}</div>
                            </el-card>
                        </div>
                        <div class="pagenum">
                            <ul class="pagination">
                                <li>
                                    <a href="#">&laquo;</a>
                                </li>
                                <li class="active">
                                    <a href="#">1</a>
                                </li>
                                <li class="disabled">
                                    <a href="#">/</a>
                                </li>
                                <li>
                                    <a href="#">33</a>
                                </li>
                                <li>
                                    <a href="#">&raquo;</a>
                                </li>
                            </ul>
                        </div>
                    </el-form>
                </div>
                
            </div>

            <!-- 右侧 -->
            <div class="map-menu-right h456 mt35">

                <div class="meu-box-right">
                    <div class="map-china">
                        <a href="big_screen_map.html">
                            <img src="../../static/images/icon-china.png" />
                        </a>
                    </div>
                    <div style="width:30px;margin-top:180px;margin-left:110px;">

                        <div class="icon" type="button" class="btn btn-success" data-container="body" data-toggle="popover" data-placement="left"
                            data-content="消防主体">
                            <span class="glyphicon glyphicon-home" style="color:#008B00"></span>
                        </div>

                        <div class="icon" class="icon" type="button" class="btn btn-success" data-container="body" data-toggle="popover" data-placement="left"
                            data-content="数字化预案">
                            <span class="glyphicon glyphicon-tasks" style="color:#00688B"></span>
                        </div>

                        <div class="icon" class="icon" type="button" class="btn btn-success" data-container="body" data-toggle="popover" data-placement="left"
                            data-content="附近500m水源">
                            <span class="glyphicon glyphicon-tint" style="color:#7B68EE"></span>
                        </div>

                        <div class="icon" class="icon" type="button" class="btn btn-success" data-container="body" data-toggle="popover" data-placement="left"
                            data-content="附近1000m水源">
                            <span class="glyphicon glyphicon-tint" style="color:#7B68EE"></span>
                        </div>

                        <div class="icon" class="icon" type="button" class="btn btn-success" data-container="body" data-toggle="popover" data-placement="left"
                            data-content="附近500m消防力量">
                            <span class="glyphicon glyphicon-user" style="color:#FF4500"></span>
                        </div>

                        <div class="icon" class="icon" type="button" class="btn btn-success" data-container="body" data-toggle="popover" data-placement="left"
                            data-content="附近1000m消防力量">
                            <span class="glyphicon glyphicon-user" style="color:#FF4500"></span>
                        </div>

                    </div>
                </div>
            </div>
            <div id="BMap" class="map-main tc">
            </div>

        </div>
    </div>
</body>
<!-- 引入js -->
<script src="../../static/js/jquery-3.2.1.min.js"></script>
<script src="../../static/js/vue.min.js"></script>
<script src="../../static/js/element.js" charset="utf-8"></script>
<script src="../../static/js/bootstrap.min.js"></script>


<script>
    $(function () { $("[data-toggle='popover']").popover(); }); 
</script>


<script type="text/javascript" src="http://api.map.baidu.com/library/TextIconOverlay/1.2/src/TextIconOverlay_min.js"></script>
<script type="text/javascript" src="http://api.map.baidu.com/library/MarkerClusterer/1.2/src/MarkerClusterer_min.js"></script>


<!-- 引入地图 -->
<script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=vRjF5BxHdpmTZZfuSzXeV2ZKLNNv7nKn"></script>
<script>
    var vm = new Vue({
        el: "#app",
        data: {
            city: '',
            marker1: '',
            marker2: '',
            marker3: '',
            markers:[],
            form: {
                delivery1: true,
                delivery2: true,
                delivery3: true
            },
            options: [
                { value: '北京', label: '北京' },
                { value: '天津', label: '天津' },
                { value: '河北', label: '河北' },
                { value: '山西', label: '山西' },
                { value: '内蒙古', label: '内蒙古' },
                { value: '辽宁', label: '辽宁' },
                { value: '吉林', label: '吉林' },
                { value: '黑龙江', label: '黑龙江' },
                { value: '上海', label: '上海' },
                { value: '江苏', label: '江苏' },
                { value: '浙江省', label: '浙江省' },
                { value: '安徽', label: '安徽' },
                { value: '福建', label: '福建' },
                { value: '江西', label: '江西' },
                { value: '山东', label: '山东' },
                { value: '河南', label: '河南' },
                { value: '湖北', label: '湖北' },
                { value: '湖南', label: '湖南' },
                { value: '广东', label: '广东' },
                { value: '广西', label: '广西' },
                { value: '海南', label: '海南' },
                { value: '重庆', label: '重庆' },
                { value: '四川', label: '四川' },
                { value: '贵州', label: '贵州' },
                { value: '云南', label: '云南' },
                { value: '西藏', label: '西藏' },
                { value: '陕西', label: '陕西' },
                { value: '甘肃省', label: '甘肃省' },
                { value: '青海', label: '青海' },
                { value: '宁夏', label: '宁夏' },
                { value: '新疆', label: '新疆' }],
            selectedOptions: [],
            selectedOptions2: [],
            tableData: [
                {
                    DWMC: "辽宁省人民法院",
                    XZQY: "辽宁省",
                    DWDZ: "霞飞路29号",
                    XFGXJGNAME: "沈阳市消防局",
                    CJSJ: "2012-02-23",
                    DWDJ: "省部级",
                    DWXZ: "司法",
                    DWDH: "1234567",
                    ID: "1"
                },
                {
                    DWMC: "辽宁省政府",
                    DWDJ: "省部级",
                    DWXZ: "行政",
                    XZQY: "辽宁省",
                    DWDZ: "霞飞路30号",
                    ZDMJ: 50000,
                    XFGXJGID: "沈阳市消防局",
                    DWDH: "1234567",
                    ID: "2"
                },
                {
                    DWMC: "辽宁省就业局",
                    DWDJ: "省部级",
                    DWXZ: "民事",
                    XZQY: "辽宁省",
                    DWDZ: "霞飞路31号",
                    ZDMJ: 20000,
                    XFGXJGID: "沈阳市消防局",
                    DWDH: "1234567",
                    ID: "3"
                }
                ,
                {
                    DWMC: "沈阳市城市规划管理局",
                    DWDJ: "市厅级",
                    DWXZ: "城市管理",
                    XZQY: "辽宁省",
                    DWDZ: "霞飞路32号",
                    ZDMJ: 10000,
                    XFGXJGID: "沈阳市消防和平分队",
                    DWDH: "1234567",
                    ID: "4"
                },
                {
                    DWMC: "沈阳市公安局",
                    DWDJ: "市厅级",
                    DWXZ: "司法",
                    XZQY: "辽宁省",
                    DWDZ: "霞飞路33号",
                    ZDMJ: 12000,
                    XFGXJGID: "沈阳市消防沈河分队",
                    DWDH: "1234567",
                    ID: "5"
                },
                {
                    DWMC: "沈阳市地铁二号线",
                    DWDJ: "市厅级",
                    DWXZ: "民事",
                    XZQY: "辽宁省",
                    DWDZ: "霞飞路34号",
                    ZDMJ: 1000,
                    XFGXJGID: "沈阳市消防浑南分队",
                    DWDH: "1234567",
                    ID: "6"
                },
                {
                    DWMC: "青岛市塑性加工园",
                    DWDJ: "市厅级",
                    DWXZ: "城市管理",
                    XZQY: "山东省",
                    DWDZ: "文明路39号",
                    ZDMJ: 2000,
                    XFGXJGID: "青岛市市消防大东分队",
                    DWDH: "1234567",
                    ID: "7"
                },
                {
                    DWMC: "泰安市城建局",
                    DWDJ: "市厅级",
                    DWXZ: "城市管理",
                    XZQY: "山东省",
                    DWDZ: "法防路36号",
                    ZDMJ: 2000,
                    XFGXJGID: "泰安市消防塔湾分队",
                    DWDH: "1234567",
                    ID: "8"
                },
                {
                    DWMC: "河北省国土资源厅",
                    DWDJ: "省部级",
                    DWXZ: "城市管理",
                    XZQY: "河北省",
                    DWDZ: "格调路46号",
                    ZDMJ: 3000,
                    XFGXJGID: "河北省消防总队",
                    DWDH: "1234567",
                    ID: "9"
                },
                {
                    DWMC: "秦皇岛市林业局",
                    DWDJ: "市厅级",
                    DWXZ: "城市管理",
                    XZQY: "河北省",
                    DWDZ: "发文路64号",
                    ZDMJ: 4000,
                    XFGXJGID: "秦皇岛市消防大队",
                    DWDH: "1234567",
                    ID: "10"
                }
            ]
        },
        methods: {

            getMarkers: function () {
                if (this.form.delivery1) {
                    this.marker1.show();
                } else {
                    this.marker1.hide();
                }
            },

            getMarker1: function () {
                if (this.form.delivery1) {
                    this.marker1.show();
                } else {
                    this.marker1.hide();
                }
            },
            getMarker2: function () {
                if (this.form.delivery2) {
                    this.marker2.show();
                } else {
                    this.marker2.hide();
                }
            },
            getMarker3: function () {
                if (this.form.delivery3) {
                    this.marker3.show();
                } else {
                    this.marker3.hide();
                }
            },
            getCity: function () {
                var url = location.href;
                var tmp1 = url.split("?")[1];
                var city1 = tmp1.split("=")[1];
                this.city = decodeURI(city1);
            },
            getBoundary: function (map) {
                var bdary = new BMap.Boundary();
                bdary.get(this.city, function (rs) { //获取行政区域
                    // map.clearOverlays(); //清除地图覆盖物 
                    var count = rs.boundaries.length; //行政区域的点有多少个
                    for (var i = 0; i < count; i++) {
                        var ply = new BMap.Polygon(rs.boundaries[i], { strokeWeight: 2, strokeColor: "#ff0000" }); //建立多边形覆盖物
                        ply.setFillColor("none");
                        map.addOverlay(ply); //添加覆盖物
                        map.setViewport(ply.getPath()); //调整视野 
                    }
                });
            },

            function(x, y){
            axios.post('/dpapi/importantunits/list', params).then(function(res){
                this.markers = res.data.result;
                this.total = res.data.result.length;
                this.loading = false;
                }.bind(this),function(error){
                    console.log(error);
                })
             },
             

            // addLayer: function(layerId, collection, visible) {
            //     var me = this;
            //     var layerConfigs = me.layerConfigs;
            //     var layerConfig = layerConfigs[layerId];
            //     var map = me.getMap();

            //     if (!map || collection.getCount() == 0) {
            //         return;
            //     }

            //     var overlayCollection = layerConfig.collection;
            //     overlayCollection.clear();
            //     collection.each(function(item) {
            //         var record = item.entity;
            //         var overlay = me.createOverlay(map, layerId, record);
            //         if (!!overlay) {
            //             overlayCollection.add(record.get('uuid'), overlay);
            //         }
            //     });

            //     var displayStyle = layerConfig.displayStyle;
            //     if (displayStyle == 'overlay') {
            //         overlayCollection.each(function(overlay) {
            //             map.addOverlay(overlay);

            //             if (visible) {
            //                 overlay.show();
            //             } else {
            //                 overlay.hide();
            //             }
            //         });
            //     } else if (displayStyle == 'clusterer') {
            //         var clusterer = layerConfig.clusterer;
            //         if (clusterer == null) {
            //             clusterer = new BMapLib.MarkerClusterer(
            //                 map);

            //             var styles = layerConfig.clustererStyles;
            //             if (!!styles) {
            //                 clusterer.setStyles(styles);
            //             }
            //         }

            //         clusterer.clearMarkers();
            //         var overlays = overlayCollection.getRange();
            //         if (visible) {
            //             clusterer.addMarkers(overlays);
            //         } else {
            //             clusterer.removeMarkers(overlays);
            //         }

            //         layerConfig.clusterer = clusterer;
            //     }
            // },

        //     toggleLayer: function(layerId, visible) {
        //         var me = this;
        //         var layerConfigs = me.layerConfigs;
        //         var layerConfig = layerConfigs[layerId];
        //         var overlayCollection = layerConfig.collection;

        //         if (overlayCollection.getCount() == 0) {
        //             return;
        //         }

        //         var displayStyle = layerConfig.displayStyle;
        //         if (displayStyle == 'overlay') {
        //             overlayCollection.each(function(overlay) {
        //                 if (visible) {
        //                     overlay.show();
        //                 } else {
        //                     overlay.hide();
        //                 }
        //             });
        //         } else if (displayStyle == 'clusterer') {
        //             var overlays = overlayCollection.getRange();
        //             var clusterer = layerConfig.clusterer;
        //             if (!!clusterer) {
        //                 if (visible) {
        //                     clusterer.addMarkers(overlays);
        //                 } else {
        //                     clusterer.removeMarkers(overlays);
        //                 }
        //             }
        //         }
        //     },


            drawMap: function () {
                //百度地图API功能
                var content =

                    '<div style="margin:0;line-height:20px;padding:2px;width:320px">' +
                    '<img src="../../static/images/zdqy.png" alt="" style="border-radius:5px; box-shadow: 1px 2px 1px rgba(0,0,128,0.5);float:left;zoom:1;overflow:hidden;width:100px;height:140px;margin-right:3px;"/>' +
                    '<br/>单位名称：泰安市城建局' +
                    '<br/>单位地址：法防路36号' +
                    '<br/>单位电话：123456' +
                    '<br/>消防管辖：泰安市消防塔湾分队' +
                    '</div>'
                    +
                    '<div style="border:1px solid rgba(0,0,128,0.5);margin-top:50px;padding:5px;border-radius:5px;width:100%;box-shadow: 1px 2px 1px rgba(0,0,128,0.5);">' +
                    '二维预案' +
                    '<a style="color:blue;margin-left:80px;">' +
                    '预览' +
                    '</a>' +
                    '<a style="color:red;margin-left:90px;">' +
                    '下载' +
                    '</a>' +
                    '</div>' +
                    '<div style="margin-bottom:10px;border:1px solid rgba(0,0,128,0.5);margin-top:10px;padding:5px;border-radius:5px;width:100%;box-shadow: 1px 2px 1px rgba(0,0,128,0.5);">' +
                    '三维预案' +
                    '<a style="color:blue;margin-left:80px;">' +
                    '预览' +
                    '</a>' +
                    '<a style="color:red;margin-left:90px;" onclick="downloadPlan()">' +
                    '下载' +
                    '</a>' +
                    '</div>'

                    ;

                var map = new BMap.Map("BMap");    //创建Map实例
                map.centerAndZoom(ggPoint, 11); 
                var top_left_control = new BMap.ScaleControl({
                    anchor:BMAP_ANCHOR_TOP_LEFT
                });
     
	            map.addControl(top_left_control); 
                //添加地图类型控件
                map.addControl(new BMap.MapTypeControl({
                    mapTypes: [
                        BMAP_NORMAL_MAP,
                        BMAP_HYBRID_MAP
                    ]
                }
                )
                );
                 

                map.setCurrentCity(this.city);      //设置地图显示的城市 此项是必须设置的
                map.centerAndZoom(this.city);       //设置地图中心点
                map.enableScrollWheelZoom(true);      //开启鼠标滚轮缩放
                map.setMinZoom(5);       //设置地图最小缩放级别
                this.getBoundary(map);   //绘制边框

                
                var ggPoint = new BMap.Point(x,y);


                var point1 = new BMap.Point(116.404, 39.915);     // 创建坐标点
                var point2 = new BMap.Point(106.425, 25.900);     // 创建坐标点
                var point3 = new BMap.Point(118.404, 37.915);     // 创建坐标点
                var point4 = new BMap.Point(123.442351,41.820069);     // 创建坐标点
                var point5 = new BMap.Point(123.441111,41.821732);     // 创建坐标点
                var point6 = new BMap.Point(123.440015,41.821349);     // 创建坐标点
                var point7 = new BMap.Point(123.428759,41.824015);     // 创建坐标点
                var point8 = new BMap.Point(123.451432,41.824687);     // 创建坐标点
                var point9 = new BMap.Point(123.443456,41.829766);     // 创建坐标点
                var point10 = new BMap.Point(123.441839,41.814687);    // 创建坐标点
                var point11 = new BMap.Point(123.454056,41.823397);    // 创建坐标点
                var point12 = new BMap.Point(123.436269,41.828503);    // 创建坐标点
                var point13 = new BMap.Point(123.44421,41.823182);     // 创建坐标点
                var point14 = new BMap.Point(123.452259,41.821058);    // 创建坐标点
                var point15 = new BMap.Point(123.433071,41.819822);    // 创建坐标点
                var point16 = new BMap.Point(123.428364,41.81829);     // 创建坐标点
                var point17 = new BMap.Point(123.433933,41.814204);    // 创建坐标点
                var point18 = new BMap.Point(123.454379,41.811838);    // 创建坐标点
                var point19 = new BMap.Point(123.452349,41.817967);    // 创建坐标点
                var point20 = new BMap.Point(123.450893,41.815118);    // 创建坐标点
                var point21 = new BMap.Point(123.448064,41.813854);    // 创建坐标点

                var myIcon1 = new BMap.Icon("../../static/images/marker_hydrant_map.png", new BMap.Size(25, 25));      //创建图标
                var myIcon2 = new BMap.Icon("../../static/images/marker_xfc_map.png", new BMap.Size(45, 45));      //创建图标
                var myIcon3 = new BMap.Icon("../../static/images/marker_qyd_map.png", new BMap.Size(25, 25));      //创建图标

                var marker1 = new BMap.Marker(point1, { icon: myIcon1 });      // 创建标注
                var marker2 = new BMap.Marker(point2, { icon: myIcon2 });      // 创建标注
                var marker3 = new BMap.Marker(point3, { icon: myIcon3 });      // 创建标注
   
                var marker4 = new BMap.Marker(point4, { icon: myIcon1 });      // 创建标注
                var marker5 = new BMap.Marker(point5, { icon: myIcon2 });      // 创建标注
                var marker6 = new BMap.Marker(point6, { icon: myIcon3 });      // 创建标注
                var marker7 = new BMap.Marker(point7, { icon: myIcon1 });      // 创建标注
                var marker8 = new BMap.Marker(point8, { icon: myIcon2 });      // 创建标注
                var marker9 = new BMap.Marker(point9, { icon: myIcon3 });      // 创建标注
                var marker10 = new BMap.Marker(point10, { icon: myIcon1 });      // 创建标注
                var marker11 = new BMap.Marker(point11, { icon: myIcon2 });      // 创建标注
                var marker12 = new BMap.Marker(point12, { icon: myIcon3 });      // 创建标注
                var marker13 = new BMap.Marker(point13, { icon: myIcon1 });      // 创建标注
                var marker14 = new BMap.Marker(point14, { icon: myIcon2 });      // 创建标注
                var marker15 = new BMap.Marker(point15, { icon: myIcon3 });      // 创建标注
                var marker16 = new BMap.Marker(point16, { icon: myIcon1 });      // 创建标注
                var marker17 = new BMap.Marker(point17, { icon: myIcon2 });      // 创建标注
                var marker18 = new BMap.Marker(point18, { icon: myIcon3 });      // 创建标注
                var marker19 = new BMap.Marker(point19, { icon: myIcon1 });      // 创建标注
                var marker20 = new BMap.Marker(point20, { icon: myIcon2 });      // 创建标注
                var marker21 = new BMap.Marker(point21, { icon: myIcon3 });      // 创建标注


                var infoWindow = new BMap.InfoWindow(content);  // 创建信息窗口对象//悬浮框
                map.centerAndZoom(point3, 15);//悬浮框

                map.addOverlay(markers);

                map.addOverlay(marker1);  // 将标注添加到地图中
                map.addOverlay(marker2);  // 将标注添加到地图中
                map.addOverlay(marker3);  // 将标注添加到地图中
                
                map.addOverlay(marker4);  // 将标注添加到地图中
                map.addOverlay(marker5);  // 将标注添加到地图中
                map.addOverlay(marker6);  // 将标注添加到地图中
                map.addOverlay(marker7);  // 将标注添加到地图中
                map.addOverlay(marker8);  // 将标注添加到地图中
                map.addOverlay(marker9);  // 将标注添加到地图中
                map.addOverlay(marker10);  // 将标注添加到地图中
                map.addOverlay(marker11);  // 将标注添加到地图中
                map.addOverlay(marker12);  // 将标注添加到地图中
                map.addOverlay(marker13);  // 将标注添加到地图中
                map.addOverlay(marker14);  // 将标注添加到地图中
                map.addOverlay(marker15);  // 将标注添加到地图中
                map.addOverlay(marker16);  // 将标注添加到地图中
                map.addOverlay(marker17);  // 将标注添加到地图中
                map.addOverlay(marker18);  // 将标注添加到地图中
                map.addOverlay(marker19);  // 将标注添加到地图中
                map.addOverlay(marker20);  // 将标注添加到地图中
                map.addOverlay(marker21);  // 将标注添加到地图中
              



                //悬浮框
                marker3.addEventListener("click", function () {
                    this.openInfoWindow(infoWindow);
                    //图片加载完毕重绘infowindow
                    document.getElementById('imgDemo').onload = function () {
                        infoWindow.redraw();   //防止在网速较慢，图片未加载时，生成的信息框高度比图片的总高度小，导致图片部分被隐藏
                    }
                });



                //点聚合
                var MAX = 21;
                var marker = [];
                var pt = null;
                var i = 0;
                for (; i < MAX; i++) {
                    pt = new BMap.Point(Math.random() * 40 + 85, Math.random() * 30 + 21);
                    markers.push(new BMap.Marker(pt));
                }
                //最简单的用法，生成一个marker数组，然后调用markerClusterer类即可。
                var markerClusterer = new BMapLib.MarkerClusterer(map, {markers:markers});

                this.markers =markers;

                this.marker1 = marker1;
                this.marker2 = marker2;
                this.marker3 = marker3;
                this.marker4 = marker4;
                this.marker5 = marker5;
                this.marker6 = marker6;
                this.marker7 = marker7;
                this.marker8 = marker8;
                this.marker9 = marker9;
                this.marker10 = marker10;
                this.marker11 = marker11;
                this.marker12 = marker12;
                this.marker13 = marker13;
                this.marker14 = marker14;
                this.marker15 = marker15;
                this.marker16 = marker16;
                this.marker17 = marker17;
                this.marker18 = marker18;
                this.marker19 = marker19;
                this.marker20 = marker20;
                this.marker21 = marker21;

            },

        isInCircle: function(point, centre, radius) {
                //point:点;centre:圆心;radius:圆半径;
                var r = 6371004;
                var x1 = point.lon * Math.PI / 180;
                var x2 = centre.lon * Math.PI / 180;
                var y1 = point.lat * Math.PI / 180;
                var y2 = centre.lat * Math.PI / 180;
                var dx = Math.abs(x1 - x2);
                var dy = Math.abs(y1 - y2);
                var p = Math.pow(Math.sin(dy / 2), 2) + Math.cos(x1) * Math.cos(x2) * Math.pow(Math.sin(dx / 2), 2);
                var d = r * 2 * Math.asin(Math.sqrt(p));
                if (radius >= d) {
                    return true;   //在圆内
                } else {
                    return false;   //在圆外
                }
            }

        },
        mounted() {
            this.getCity()
            this.drawMap()
            document.title = this.city + '预案情况'
        }
    })
</script>
<script>
    $('#menu-toggle-btn').click(function () {
        var left = $('.map-menu-left'),
            main = $('.map-main'),
            $this = $(this);
        if (left.hasClass('damin')) {
            left.removeClass('damin').css('left', '40px');
            main.css('padding-left', '240px');
            setTimeout(function () {
                $this.removeClass('menu-toggle-bg').css({ "right": "0", "transform": "rotateY(0)" });
            }, 300);
        } else {
            left.addClass('damin').css('left', '-240px');
            main.css('padding-left', 0);
            setTimeout(function () {
                $this.addClass('menu-toggle-bg').css({ "right": "-66px", "transform": "rotateY(180deg)" });
            }, 300);
        }
    });
    //预案下载
    function downloadPlan() {
        window.open("http://10.119.119.232:18080/upload/123456/2018-03-21/70932ac7-da58-4419-91b6-ebe0b3f53838/web%E7%89%88%E4%B8%89%E7%BB%B4%E9%A2%84%E6%A1%88.ZIP");
    }
</script>

</html>