<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <!-- 引入样式 -->
    <link rel="stylesheet" type="text/css" href="../css/element.css">
    <link rel="stylesheet" type="text/css" href="../css/zxx.lib.css">
    <link rel="stylesheet" type="text/css" href="../css/app.css">
    <!-- 引入js -->
    <script src="../lib/jquery-3.2.1.min.js"></script>
    <script src="../lib/vue.min.js"></script>
    <script src="../lib/element.js" charset="utf-8"></script>
    <!-- 引入地图 -->
    <script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=vRjF5BxHdpmTZZfuSzXeV2ZKLNNv7nKn"></script>
    <script type="text/javascript">   
        function getCity() {
            var url = location.href;
            var tmp1 = url.split("?")[1];
            var city = tmp1.split("=")[1];
            // alert(decodeURI(city));
            return (decodeURI(city));
        }
        function getBoundary() {
            var bdary = new BMap.Boundary();
            bdary.get(getCity(), function (rs) { //获取行政区域
                map.clearOverlays(); //清除地图覆盖物 
                var count = rs.boundaries.length; //行政区域的点有多少个
                for (var i = 0; i < count; i++) {
                    var ply = new BMap.Polygon(rs.boundaries[i], { strokeWeight: 2, strokeColor: "#ff0000" }); //建立多边形覆盖物
                    ply.setFillColor("none");
                    map.addOverlay(ply); //添加覆盖物
                    map.setViewport(ply.getPath()); //调整视野 
                }
            });
        }
    </script>
</head>

<body class="fw map-bg">
    <div id="app">
        <div class="application-box tc abs">
            <div class="map-menu p10">
                <el-form ref="form" :model="form" label-width="80px">
                    <el-form-item label="水源信息">
                        <el-switch v-model="form.delivery1" @change="getMarker1"></el-switch>
                    </el-form-item>
                    <el-form-item label="消防力量">
                        <el-switch v-model="form.delivery2"></el-switch>
                    </el-form-item>
                    <el-form-item label="重点单位">
                        <el-switch v-model="form.delivery3"></el-switch>
                    </el-form-item>
                </el-form>
            </div>
            <div id="BMap" class="map-main tc"></div>
        </div>
    </div>
</body>
<script>
    var vm = new Vue({
        el: "#app",
        data: {
            form: {
                delivery1: false,
                delivery2: false,
                delivery3: false
            }
        },
        methods: {
            getMarker1: function () {
                if (this.form.delivery1) {
                    marker.show();
                } else {
                    marker.hide();
                }
            }
        }
    })
</script>
<script type="text/javascript">
    // 百度地图API功能
    var map = new BMap.Map("BMap");    // 创建Map实例
    map.centerAndZoom(new BMap.Point(116.404, 39.915), 11);  // 初始化地图,设置中心点坐标和地图级别
    //添加地图类型控件
    map.addControl(new BMap.MapTypeControl({
        mapTypes: [
            BMAP_NORMAL_MAP,
            BMAP_HYBRID_MAP
        ]
    }));
    map.setCurrentCity(getCity());      // 设置地图显示的城市 此项是必须设置的
    map.centerAndZoom(getCity());       //设置地图中心点
    map.enableScrollWheelZoom(true);      //开启鼠标滚轮缩放
    getBoundary();      //绘制边框
    var marker = new BMap.Marker(new BMap.Point(116.404, 39.915));      // 创建标注
    map.addOverlay(marker);      // 将标注添加到地图中
</script>

</html>